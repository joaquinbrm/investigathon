library(ggplot2)
library(dplyr)
library(readr)
# Leer las stats por columna
cols <- read_csv("col_stats.csv")
# Agregar una columna que marque si la posición está en el barcode 30bp (49–78)
barcode_start <- 49
# Leer las stats por columna
cols <- read_csv("col_stats.csv")
library(ggplot2)
library(dplyr)
library(readr)
install.packages("readr")
library(readr)
# Leer las stats por columna
cols <- read_csv("col_stats.csv")
setwd("C:/Users/Admin/Desktop/JUAN/INVESTIGATHON")
# Leer las stats por columna
cols <- read_csv("col_stats.csv")
# Agregar una columna que marque si la posición está en el barcode 30bp (49–78)
barcode_start <- 49
barcode_end   <- 78
cols <- cols %>%
mutate(
in_barcode = ifelse(columna >= barcode_start & columna <= barcode_end, "barcode_30bp", "fuera")
)
# Entropía
ggplot(cols, aes(x = columna, y = entropia, color = in_barcode)) +
geom_line() +
geom_point(size = 1) +
scale_color_manual(values = c("fuera" = "grey50", "barcode_30bp" = "red")) +
labs(title = "Entropía por columna en el core de 82 bp",
x = "Columna (0-based en el core)",
y = "Entropía de Shannon",
color = "Región") +
theme_minimal()
# Identidad
ggplot(cols, aes(x = columna, y = identidad, color = in_barcode)) +
geom_line() +
geom_point(size = 1) +
scale_color_manual(values = c("fuera" = "grey50", "barcode_30bp" = "blue")) +
labs(title = "Identidad por columna en el core de 82 bp",
x = "Columna (0-based en el core)",
y = "Identidad (frecuencia de la base dominante)",
color = "Región") +
theme_minimal()
install.packages("ggseqlogo")
library(Biostrings)
library(ggseqlogo)
install.packages("Biostrings")
# Leer el FASTA del barcode
barcode <- readDNAStringSet("formicidae_barcode_30bp.fasta")
library(Biostrings)
install.packages("Biostrings")
